# Golden Files for Method A-32 through A-41 Tests

These golden files contain expected `pb.Definition` protobuf output for the golden file tests.

## Directory Structure

```
test/integration/
├── golden_test.go                    # Golden file tests
└── testdata/
    └── golden/
        ├── README.md                 # This file
        ├── a32_simple_image.pb      # Expected protobuf output
        ├── a33_exec_basic.pb
        ├── a34_exec_mounts.pb
        ├── a35_file_copy.pb
        ├── a36_file_ops.pb
        ├── a37_merge_basic.pb
        ├── a38_diff_basic.pb
        ├── a39_multi_stage.pb
        ├── a40_platform.pb
        └── a41_complex_dag.pb
```

## Golden File Format

Each golden file is a raw protobuf bytes file (`.pb`) generated by running:
```bash
./luakit build -o test/integration/testdata/golden/<scenario>.pb <scenario>.lua
```

## Scenarios

| File | Scenario | Description |
|------|----------|-------------|
| `a32_simple_image.pb` | A-32 | Simple image export |
| `a33_exec_basic.pb` | A-33 | Image → run → export |
| `a34_exec_mounts.pb` | A-34 | Run with cache, secret, ssh, tmpfs |
| `a35_file_copy.pb` | A-35 | Two images + cross-state copy |
| `a36_file_ops.pb` | A-36 | Chained mkdir → mkfile → rm → symlink |
| `a37_merge_basic.pb` | A-37 | Three parallel branches merged |
| `a38_diff_basic.pb` | A-38 | Diff between base and installed |
| `a39_multi_stage.pb` | A-39 | Builder → runtime copy pattern |
| `a40_platform.pb` | A-40 | Cross-platform image pull |
| `a41_complex_dag.pb` | A-41 | Full Go app: parallel, cache, multi-stage |

## Regenerating Golden Files

To regenerate all golden files after making changes to luakit:

```bash
# Build the luakit binary first
go build -o ./luakit ./cmd/luakit

# For each scenario, run:
./luakit build -o test/integration/testdata/golden/a32_simple_image.pb test/integration/scripts/a32_simple_image.lua
# ... etc
```

## Lua Source Files

The corresponding Lua source files are stored in `test/integration/scripts/`.
